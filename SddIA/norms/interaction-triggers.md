# Normas de interacción: disparadores de usuario

**Alcance:** Comportamiento del agente cuando el usuario escribe ciertos **disparadores** en el mensaje. El dominio **SddIA** define este comportamiento; el agente debe consultar estas normas y aplicarlas.

**Fuente canónica:** Este documento y su equivalente machine-readable `interaction-triggers.json`. Las rutas de skills y tools se resuelven desde **Cúmulo** (`SddIA/agents/cumulo.json`).

---

## Disparador: #Skill

**Cuándo:** El usuario escribe `#Skill` (solo o dentro de un mensaje).

**Comportamiento:**

1. **Reconocer** que el usuario quiere ver o elegir una skill del proyecto.
2. **Sugerir las skills existentes** listando `skill_id` y descripción breve.
3. **Fuente del listado:** paths.skillsDefinitionPath (README.md, tabla de skills) y/o las carpetas en **paths.skillsDefinitionPath** (Cúmulo). Para skills con implementación ejecutable: **paths.skillsIndexPath** o **paths.skillCapsules** (Cúmulo).
4. **Formato de respuesta:** Tabla o lista clara en español; indicar cuáles tienen cápsula (paths.skillCapsules) y cuáles son solo definición.
5. **Cierre:** Ofrecer seguir con una skill concreta: *"¿Con cuál quieres trabajar o qué necesitas hacer?"* Detalle: paths.skillsDefinitionPath/<skill-id>/ (spec.md, spec.json); implementación en paths.skillCapsules[skill-id].

### Listado de referencia (actualizar si cambia paths.skillsDefinitionPath)

| skill_id | Descripción | Cápsula |
|----------|-------------|---------|
| iniciar-rama | Crea rama feat/ o fix/ actualizada con master/main. Inicio de acción. | paths.skillCapsules.iniciar-rama |
| finalizar-git | Aceptar PR a master, unificar, eliminar rama, volver a master. | paths.skillCapsules.finalizar-git |
| invoke-command | Interceptor de comandos de sistema (git, dotnet, npm, pwsh). | paths.skillCapsules.invoke-command |
| git-operations | Uso seguro de Git (ramas feat/fix, commits convencionales). | — |
| documentation | Estándares SSOT y gestión de documentación. | — |
| filesystem-ops | Operaciones de archivo seguras (PowerShell). | — |
| dotnet-development | Estándares .NET (build, test, logging). | — |
| frontend-build | Build Next.js (Product, Admin) fallback. | — |
| frontend-test | Tests unitarios y E2E frontend. | — |
| security-audit | Auditoría y hooks pre-commit/pre-push. | — |

---

## Disparador: #Action

**Cuándo:** El usuario escribe `#Action` (solo o dentro de un mensaje).

**Comportamiento:**

1. **Reconocer** que el usuario quiere ver o elegir una acción del ciclo de desarrollo.
2. **Sugerir las acciones existentes** listando action_id y descripción breve.
3. **Fuente del listado:** paths.actionsPath (Cúmulo) — cada acción en carpeta paths.actionsPath/<action-id>/ (spec.md, spec.json). Orden típico en el proceso feature: spec → clarify → planning → implementation → execution → validate → finalize.
4. **Formato de respuesta:** Tabla o lista clara en español con action_id y propósito.
5. **Cierre:** Ofrecer seguir con una acción concreta: *"¿Cuál quieres ejecutar o sobre cuál necesitas detalle?"* Detalle: paths.actionsPath/<action-id>/ (spec.md, spec.json).

### Listado de referencia (actualizar si cambia paths.actionsPath)

| action_id | Descripción |
|-----------|-------------|
| spec | Especificación: transformar requerimientos en SPEC técnico formal. Entrada del ciclo. |
| clarify | Clarificación: resolver ambigüedades y gaps en SPECs antes de planificación. |
| planning | Plan: convertir spec y clarificaciones en hoja de ruta técnica ejecutable. |
| implementation | Implementación (doc): indicar touchpoints en código y documento de implementación; no modifica código. |
| execution | Ejecución: aplicar al código los cambios del documento de implementación. |
| validate | Validación: comprobar calidad antes del PR (git diff, build, tests, docs); generar validacion.json. |
| finalize | Finalizar: cierre del ciclo (commits, Evolution Logs, push, PR a master). Usa skill finalizar-git. |
| sddia-difusion | Difusión de SddIA: mantener .cursor/rules, .github y otros gestores IA alineados con AGENTS y SddIA/norms. |

---

## Disparador: #Process

**Cuándo:** El usuario escribe `#Process` (solo o dentro de un mensaje).

**Comportamiento:**

1. **Reconocer** que el usuario quiere ver o elegir un proceso de tarea.
2. **Sugerir los procesos existentes** listando el identificador y descripción breve.
3. **Fuente del listado:** paths.processPath (Cúmulo: README.md y carpetas por proceso). Cada proceso tiene carpeta &lt;process-id&gt;/ con spec.md y spec.json (contrato: process-contract.json).
4. **Formato de respuesta:** Tabla o lista clara en español con process_id y propósito; indicar definición: paths.processPath/&lt;process-id&gt;/.
5. **Cierre:** Ofrecer seguir con un proceso: *"¿Con cuál quieres iniciar una tarea o necesitas detalle?"* Detalle: paths.processPath/README.md y paths.processPath/&lt;process-id&gt;/ (spec.md, spec.json).

### Listado de referencia (actualizar si cambia paths.processPath)

| process_id | Descripción | Definición |
|------------|-------------|------------|
| feature | Desarrollo de una funcionalidad: rama feat/&lt;nombre_feature&gt;, documentación en paths.featurePath/&lt;nombre_feature&gt;/ (Cúmulo). | paths.processPath/feature/ |
| bug-fix | Corrección de un bug: rama fix/&lt;nombre_fix&gt;, documentación en paths.fixPath/&lt;nombre_fix&gt;/ (Cúmulo). Alcance mínimo. | paths.processPath/bug-fix/ |
| refactorization | Refactorización: rama feat/refactorization-&lt;nombre_refactor&gt;, documentación en paths.featurePath/refactorization-&lt;nombre_refactor&gt;/ (Cúmulo). | paths.processPath/refactorization/ |
| create-tool | Creación de una nueva herramienta: rama feat/create-tool-&lt;tool-id&gt;, cápsula en paths.toolCapsules, índice y Cúmulo actualizados. | paths.processPath/create-tool/ |
| correccion-auditorias | Corrección de hallazgos de auditoría: rama feat/correccion-segun-auditorias o feat/correccion-auditorias-&lt;id&gt;, documentación en paths.featurePath. Entrada: paths.auditsPath. | paths.processPath/correccion-auditorias/ |
| create-template | Creación de plantilla: rama feat/create-template-&lt;template-id&gt;, carpeta en paths.templatesPath. Configuración predefinida de proceso con fin concreto. | paths.processPath/create-template/ |

---

## Disparador: subir (acción ejecutable)

**Cuándo:** El usuario escribe **subir**, **subir la rama**, **subir a la nube** o pide explícitamente publicar la rama en el remoto (en el contexto de finalize o cierre).

**Comportamiento:**

1. **Reconocer** que el usuario quiere que la rama actual se publique en el remoto (`origin`).
2. **Ejecutar el push:** Desde la raíz del repo, en PowerShell: obtener la rama actual con `git branch --show-current`, luego ejecutar `git push -u origin <rama_actual>`. Entorno: Windows, PowerShell; no usar bash.
3. **Comprobar resultado:** Leer la salida del comando. Si hay error (credenciales, red, rama rechazada), informar al usuario con el mensaje de error. Si hay éxito (ej. `branch '...' set up to track 'origin/...'` o `Everything up-to-date`), confirmar que la rama está subida.
4. **No sustituir por documentación:** El agente no debe limitarse a decir que «el paso es subir»; debe **ejecutar** el comando de push y reportar el resultado.

**Relación con finalize:** La acción finalize (paths.actionsPath/finalize/) incluye este paso como obligatorio; cuando el usuario pide «subir» o «finalizar» (y se aplica el cierre), el agente debe ejecutar el push.

---

## Otros disparadores (reservado)

En este documento se podrán añadir más disparadores (p. ej. `#Tool`) con el mismo formato: cuándo, comportamiento, fuente del listado.

---
*El comportamiento del agente ante el usuario lo define el dominio SddIA. Referencia: AGENTS.md (protocolo maestro).*
